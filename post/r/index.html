<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>R★ | MaoMaoHead</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://maomaohead.github.io/favicon.ico?v=1698221429143">
<link rel="stylesheet" href="https://maomaohead.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="建立、查询表格
manager=c(1,2,3,4,5)
date=c(&quot;10/24/08&quot;,&quot;10/28/08&quot;,&quot;10/1/08&quot;,&quot;10/12/08&quot;,&..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://maomaohead.github.io">
        <img src="https://maomaohead.github.io/images/avatar.png?v=1698221429143" class="site-logo">
        <h1 class="site-title">MaoMaoHead</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="https://maomaohead.github.io/post/mu-lu" class="site-nav">
            索引
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      爆肝蓝色生死恋
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://maomaohead.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">R★</h2>
            <div class="post-date">2023-09-26</div>
            
            <div class="post-content" v-pre>
              <p>建立、查询表格</p>
<pre><code>manager=c(1,2,3,4,5)
date=c(&quot;10/24/08&quot;,&quot;10/28/08&quot;,&quot;10/1/08&quot;,&quot;10/12/08&quot;,&quot;5/1/09&quot;)
country=c(&quot;US&quot;,&quot;US&quot;,&quot;UK&quot;,&quot;UK&quot;,&quot;UK&quot;)
gender=c(&quot;M&quot;,&quot;F&quot;,&quot;F&quot;,&quot;M&quot;,&quot;F&quot;)
age=c(32,45,25,39,99)
q1=c(5,3,3,3,2)
q2=c(4,5,5,3,2)
q3=c(5,2,5,4,1) 
q4=c(5,5,5,NA,2)
q5=c(5,5,2,NA,1)
leadership = data.frame(manager,date,country,gender,age,q1,q2,q3,q4,q5,stringsAsFactors = FALSE)

head(leadership)

leadership[2,3]
leadership$age[2]
leadership[,5]
length(leadership$age)
leadership[5,]
leadership[c(2,4),5]

names(leadership)
names(leadership)[3]

leadership[age&gt;40,]
leadership[country==&quot;US&quot;,]
leadership[country==&quot;US&quot;&amp;gender==&quot;M&quot;,]
leadership[country==&quot;US&quot;|gender==&quot;M&quot;,]
leadership[country!=&quot;US&quot;,]

age^2
sqrt(age)
q1+q2

leadership$x1 = q1 + q2
leadership

leadership$x1=rowMeans(leadership[,6:8])
leadership

leadership$agegroup[age&gt;=40&amp;age&lt;50]=&quot;40-50&quot;
leadership$agegroup[age&lt;40]=&quot;&lt;40&quot;
leadership$agegroup[age&gt;=50]=&quot;&gt;=50&quot;
leadership

names(leadership)[4]=&quot;性 别&quot;
leadership

leadership$q4[is.na(leadership$q4)]=0
leadership

mean(leadership$q4,na.rm = T)
is.na(leadership$q4)

dates=as.Date(&quot;01/05/1965&quot;,&quot;%m/%d/%Y&quot;)
dates

leadership[order(leadership$age),]

leadership[order(leadership$age,decreasing = T),]
</code></pre>
<p>运行结果</p>
<pre><code>&gt; manager=c(1,2,3,4,5)
&gt; date=c(&quot;10/24/08&quot;,&quot;10/28/08&quot;,&quot;10/1/08&quot;,&quot;10/12/08&quot;,&quot;5/1/09&quot;)
&gt; country=c(&quot;US&quot;,&quot;US&quot;,&quot;UK&quot;,&quot;UK&quot;,&quot;UK&quot;)
&gt; gender=c(&quot;M&quot;,&quot;F&quot;,&quot;F&quot;,&quot;M&quot;,&quot;F&quot;)
&gt; age=c(32,45,25,39,99)
&gt; q1=c(5,3,3,3,2)
&gt; q2=c(4,5,5,3,2)
&gt; q3=c(5,2,5,4,1)
&gt; q4=c(5,5,5,NA,2)
&gt; q5=c(5,5,2,NA,1)
&gt; leadership = data.frame(manager,date,country,gender,age,q1,q2,q3,q4,q5,stringsAsFactors = FALSE)
&gt; 
&gt; head(leadership)
   manager     date country gender age q1 q2 q3 q4 q5
1       1 10/24/08      US      M  32  5  4  5  5  5
2       2 10/28/08      US      F  45  3  5  2  5  5
3       3  10/1/08      UK      F  25  3  5  5  5  2
4       4 10/12/08      UK      M  39  3  3  4 NA NA
5       5   5/1/09      UK      F  99  2  2  1  2  1
&gt; 
&gt; leadership[2,3]
[1] &quot;US&quot;
&gt; leadership$age[2]
[1] 45
&gt; leadership[,5]
[1] 32 45 25 39 99
&gt; length(leadership$age)
[1] 5
&gt; leadership[5,]
manager   date country gender age q1 q2 q3 q4 q5
5       5 5/1/09      UK      F  99  2  2  1  2  1
&gt; leadership[c(2,4),5]
[1] 45 39
&gt; names(leadership)
 [1] &quot;manager&quot; &quot;date&quot;    &quot;country&quot; &quot;gender&quot;  &quot;age&quot;     &quot;q1&quot;      &quot;q2&quot;      &quot;q3&quot;     
[9] &quot;q4&quot;      &quot;q5&quot;  
&gt; names(leadership)[3]
[1] &quot;country&quot;
&gt; leadership[age&gt;40,]
  manager     date country gender age q1 q2 q3 q4 q5
2       2 10/28/08      US      F  45  3  5  2  5  5
5       5   5/1/09      UK      F  99  2  2  1  2  1
&gt; leadership[country==&quot;US&quot;,]
  manager     date country gender age q1 q2 q3 q4 q5
1       1 10/24/08      US      M  32  5  4  5  5  5
2       2 10/28/08      US      F  45  3  5  2  5  5
&gt; leadership[country==&quot;US&quot;&amp;gender==&quot;M&quot;,]
  manager     date country gender age q1 q2 q3 q4 q5
1       1 10/24/08      US      M  32  5  4  5  5  5
&gt; leadership[country==&quot;US&quot;|gender==&quot;M&quot;,]
  manager     date country gender age q1 q2 q3 q4 q5
1       1 10/24/08      US      M  32  5  4  5  5  5
2       2 10/28/08      US      F  45  3  5  2  5  5
4       4 10/12/08      UK      M  39  3  3  4 NA NA
&gt; leadership[country!=&quot;US&quot;,]
  manager     date country gender age q1 q2 q3 q4 q5
3       3  10/1/08      UK      F  25  3  5  5  5  2
4       4 10/12/08      UK      M  39  3  3  4 NA NA
5       5   5/1/09      UK      F  99  2  2  1  2  1
&gt; age^2
[1] 1024 2025  625 1521 9801
&gt; sqrt(age)
[1] 5.656854 6.708204 5.000000 6.244998 9.949874
&gt; q1+q2
[1] 9 8 8 6 4
&gt; x1 = q1 + q2
&gt; leadership
  manager     date country gender age q1 q2 q3 q4 q5 x1
1       1 10/24/08      US      M  32  5  4  5  5  5  9
2       2 10/28/08      US      F  45  3  5  2  5  5  8
3       3  10/1/08      UK      F  25  3  5  5  5  2  8
4       4 10/12/08      UK      M  39  3  3  4 NA NA  6
5       5   5/1/09      UK      F  99  2  2  1  2  1  4
&gt; leadership$x1=rowMeans(leadership[,6:8])
&gt; leadership
  manager     date country gender age q1 q2 q3 q4 q5       x1
1       1 10/24/08      US      M  32  5  4  5  5  5 4.666667
2       2 10/28/08      US      F  45  3  5  2  5  5 3.333333
3       3  10/1/08      UK      F  25  3  5  5  5  2 4.333333
4       4 10/12/08      UK      M  39  3  3  4 NA NA 3.333333
5       5   5/1/09      UK      F  99  2  2  1  2  1 1.666667
&gt; leadership$agegroup[age&gt;=40&amp;age&lt;50]=&quot;40-50&quot;
&gt; leadership$agegroup[age&lt;40]=&quot;&lt;40&quot;
&gt; leadership$agegroup[age&gt;50]=&quot;&gt;50&quot;
&gt; leadership
  manager     date country gender age q1 q2 q3 q4 q5       x1 agegroup
1       1 10/24/08      US      M  32  5  4  5  5  5 4.666667      &lt;40
2       2 10/28/08      US      F  45  3  5  2  5  5 3.333333    40-50
3       3  10/1/08      UK      F  25  3  5  5  5  2 4.333333      &lt;40
4       4 10/12/08      UK      M  39  3  3  4 NA NA 3.333333      &lt;40
5       5   5/1/09      UK      F  99  2  2  1  2  1 1.666667      &gt;50
&gt; names(leadership)[4]=&quot;性 别&quot;
&gt; leadership
  manager     date country 性 别 age q1 q2 q3 q4 q5       x1 agegroup
1       1 10/24/08      US     M  32  5  4  5  5  5 4.666667      &lt;40
2       2 10/28/08      US     F  45  3  5  2  5  5 3.333333    40-50
3       3  10/1/08      UK     F  25  3  5  5  5  2 4.333333      &lt;40
4       4 10/12/08      UK     M  39  3  3  4 NA NA 3.333333      &lt;40
5       5   5/1/09      UK     F  99  2  2  1  2  1 1.666667      &gt;50
&gt; leadership
  manager     date country 性 别 age q1 q2 q3 q4 q5       x1 agegroup
1       1 10/24/08      US     M  32  5  4  5  5  5 4.666667      &lt;40
2       2 10/28/08      US     F  45  3  5  2  5  5 3.333333    40-50
3       3  10/1/08      UK     F  25  3  5  5  5  2 4.333333      &lt;40
4       4 10/12/08      UK     M  39  3  3  4  0 NA 3.333333      &lt;40
5       5   5/1/09      UK     F  99  2  2  1  2  1 1.666667      &gt;50
&gt; mean(leadership$q4,na.rm = T)
[1] 3.4
&gt; is.na(leadership$q4)
[1] FALSE FALSE FALSE FALSE FALSE
&gt; dates=as.Date(&quot;01/05/1965&quot;,&quot;%m/%d/%Y&quot;)
&gt; dates
[1] &quot;1965-01-05&quot;
&gt; leadership[order(leadership$age),]
  manager     date country 性 别 age q1 q2 q3 q4 q5       x1 agegroup
3       3  10/1/08      UK     F  25  3  5  5  5  2 4.333333      &lt;40
1       1 10/24/08      US     M  32  5  4  5  5  5 4.666667      &lt;40
4       4 10/12/08      UK     M  39  3  3  4  0 NA 3.333333      &lt;40
2       2 10/28/08      US     F  45  3  5  2  5  5 3.333333    40-50
5       5   5/1/09      UK     F  99  2  2  1  2  1 1.666667      &gt;50
&gt; 
&gt; 
&gt; leadership[order(leadership$age,decreasing = T),]
  manager     date country 性 别 age q1 q2 q3 q4 q5       x1 agegroup
5       5   5/1/09      UK     F  99  2  2  1  2  1 1.666667      &gt;50
2       2 10/28/08      US     F  45  3  5  2  5  5 3.333333    40-50
4       4 10/12/08      UK     M  39  3  3  4  0 NA 3.333333      &lt;40
1       1 10/24/08      US     M  32  5  4  5  5  5 4.666667      &lt;40
3       3  10/1/08      UK     F  25  3  5  5  5  2 4.333333      &lt;40
</code></pre>
<p>代码</p>
<pre><code>install.packages(&quot;openxlsx&quot;)
library(openxlsx)
data=read.xlsx(&quot;C:/Users/86150/Desktop/survival data.xlsx&quot;, sheet=1)

data2=data[data$初诊年龄&lt;60&amp;data$T分期==1,]
data$EAIgA[data$EAIgA==&quot;阴&quot;|data$EAIgA==&quot;阴性&quot;|data$EAIgA==&quot;-&quot;|data$EAIgA==&quot;&quot;]=0

data$EAIgA=as.numeric(data$EAIgA)

mean(data2$EAIgA,na.rm = T)

table(data2$性别,data2$吸烟与否)

plot(data2$LDH,data2$Overall.survival.time)

data2$kk[data2$LDH&gt;200]=&quot;High&quot;
data2$kk[data2$LDH&lt;=200]=&quot;Low&quot;

data2$k=ifelse(data2$EAIgA&lt;=200,&quot;low&quot;,&quot;high&quot;)

for(i in 1:100){
  if(data2$LDH[i]&lt;200) data2$kk[i]=&quot;low&quot; else data2$kk[i]=&quot;high&quot;
}

junshu=mean(data2$LDH)
biaozhuncha=sd(data$LDH)
junshu
biaozhuncha
round(junshu,2)
round(biaozhuncha,2)
junshu
biaozhuncha

sprintf(&quot;%.2f&quot;,junshu)
sprintf(&quot;%.2f&quot;,biaozhuncha)
paste0(sprintf(&quot;%.2f&quot;,junshu),&quot;±&quot;,sprintf(&quot;%.2f&quot;,biaozhuncha))



mean_Z=function(var){
junshu=mean(var)
biaozhuncha=sd(var)
paste0(sprintf(&quot;%.2f&quot;,junshu),&quot;±&quot;,sprintf(&quot;%.2f&quot;,biaozhuncha))
}
mean_Z(data2$LDH)
mean_Z(data2$EALgA)
mean_Z(data2$初诊年龄)

#自编一个输入两个分类变量的名字就可以返回四格表的函数

Ptable=function(var1,var2){
a=table(var1,var2)
b=chisq.test(a)
c=b$statistic
d=b$p.value
return(list(a,b,c,d))
}
Ptable(data$性别,data$吸烟与否)
</code></pre>

            </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://maomaohead.github.io/post/write-an-essay-on-health-risk-factors/">
                  <h3 class="post-title">
                    Write an essay on health risk factors
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
</html>
